Jade Minzlaff
BIOEN 537 Computational Systems Biology
Package Name: simulate_xna_signal.py
Functional specification

Background: 
In nanopore DNA sequencing, a sequence of nucleic acids is passed through a protein nanopore, and the change in current for each nucleic acid is recorded as a step graph [1]. Each nucleic acid produces a unique and predictable current value, allowing the genetic sequence to be decoded from the signal using a base-calling program, such as Remora [2]. 

Conventional genetic code sequencing is based on experimentally determined current values produced by each base (A, T, G, C, U), and basecallers like Remora are not designed to decode genetic sequences which include synthetic, non-standard nucleic acids, known as XNAs. This motivates the creation of tools to aid in sequencing and decoding of XNAs.

This tool will take a genetic sequence including XNAs as an input, and will output the predicted nanopore signal plot for the sequence.  

This tool was trained using experimentally measured nanopore sequencing signals from known sequences of XNAs by the XenoBio Lab at the University of Washington (PI: Jorge Marchand). The specific XNAs included in this study are from the Artificially Expanded Genetic Information System (AEGIS), and are abbreviated as J, K, P, Sc, Sn, V, X, and Z. 

tldr: pip-installable python package to simulate the expected nanopore signal produced by a given genetic sequence including unnatural base pairs (XNA). 

Sources: 
[1] https://nanoporetech.com/applications/dna-nanopore-sequencing
[2] https://github.com/nanoporetech/remora

User Profile: 
This tool is intended for use by lab workers who perform nanopore sequencing of segments of nucleic acids and wish to have a reference to compare to their generated signals, particularly those working with AEGIS XNA bases. This population could include lab technicians, grad students, and research scientists in the fields of synthetic biology and genomics. The ideal user is able to download packages with pip and has a basic proficiency in using Python, but advanced programming skills are not required to use this tool. 

Use cases: 
Hypothetical use cases for generating an expected nanopore signal for a known sequence of nucleic acids that includes XNAs: 
Use case 1: User seeks to compare their experimental raw nanopore sequence plot to a reference in order to rapidly check if the sequence looks correct before decoding. In this case, the user would superimpose their experimental data over the plot generated by this tool, allowing them to visually notice any large deviations between the two and to investigate potential mispairings, mutations, or experimental errors before continuing on to decode their sequence. This tool would provide a reference to increase the user’s confidence in their own data and to decrease time lost decoding poor quality data. 

Use Case 2: User mixes up their notes and has a raw nanopore signal graph which could correlate to one of multiple possible genetic sequences, and seeks a visual tool to rapidly compare their signal to several potential sequences to determine which is most likely to be correct. This tool would provide a rapid visual aid to increase the user’s confidence in the sequence corresponding to their data, decreasing time spent rerunning data collection. 

Preliminary Project Plan

Train model: 
Download database for typical plots produced by DNA (given by lab), in format of a folder containing .csv files of the average signal value for each possible kmer.
Merage all kmer data into one “master” .csv file in the same folder as script. 
Convert all .csv files into tables readable by Python using Panda
Extract from the table the relevant information organized into paired “inputs”(kmers) and “output” data (current level). This is the training set for the model. 
Generate plot:
Create a for-loop to generate the plot, so that for each given input sequence, a segment of the plot with the appropriate current is added to the output, using step() function in matplotlib. 
Add noise to simulated data
Create a user-interface to prompt the user to input DNA sequence.



